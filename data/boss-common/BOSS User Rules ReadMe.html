<!DOCTYPE html>
<meta charset="utf-8">
<title>BOSS User Rules ReadMe</title>
<style>
	body {font-family:Calibri,Arial,Verdana,sans-serifs;}
	li {margin-bottom:10px;}
	li ul, li ol {margin-top:0.4em;}
	q {font-style:italic;}
	code {display:inline-block; padding:2px 5px; background:#eee;}
	td {border:1px solid #ccc; padding: 5px; vertical-align:top;}
	table {border:1px solid #ccc; border-spacing:0; border-collapse:separate; margin:1em;}
	thead > tr td {font-weight:bold}
	code.box {line-height:20px; white-space:pre; margin:1em 0 0 3em; display:table; padding:5px 10px;}
	ol li ol {list-style:lower-alpha;}
	blockquote {background:#E6E6FA; display:table; padding:5px 30px 5px 10px;}
	h1 { text-align:center;}
	h2 {margin-top:3em;}
	h3 {margin-top:2em;}
	a:link {text-decoration:none;}
	a:hover {text-decoration:underline;}
</style>

<h1>BOSS User Rules Readme</h1>

<h2>Contents</h2>
<ol>
	<li><a href="#intro">Introduction</a>
	<li><a href="#start">Getting Started With The Userlist</a>
	<li><a href="#basics">Rule Basics</a>
	<ol>
		<li><a href="#basics-add">Sorting An Unknown Plugin</a>
		<li><a href="#basics-override">Changing A Recognised Plugin's Position</a>
		<li><a href="#basics-message">Editing A Plugin's BOSS Log Messages &amp; Bash Tag Suggestions</a>
	</ol>
	<li><a href="#syntax">Rule Definition Syntax</a>
	<ol>
		<li><a href="#syntax-rule">The Rule Line</a>
		<li><a href="#syntax-sort">The Sort Line</a>
		<li><a href="#syntax-message">The Message Line</a>
		<li><a href="#syntax-examples">Examples</a>
	</ol>
	<li><a href="#apply">Enforcing Your Rules</a>
	<li><a href="#notes">Further Notes On Rules</a>
	<li><a href="#messages">The BOSS Message Format</a>
	<li><a href="#license">License</a>
</ol>

<h2 id="intro">Introduction</h2>
<p>While BOSS is able to sort the large number of plugins listed in its masterlist without any user input, you may find that you wish to customise 
the sorting of your plugins. This may be to include plugins not listed in the masterlist (either plugins not yet added or temporary plugins or private files not suitable for masterlist inclusion), or it could be to rearrange plugins present in the masterlist that can be loaded in a different configuration 
for different results (eg. LAME and Supreme Magicka files). You may also wish to add extra messages to plugins, or edit existing messages.
<p>One possible solution is to edit your copy of the masterlist to include the desired changes. However, as updating your masterlist will remove 
these edits, this is not very suitable as a long term solution.
<p>This is where user rules come in. Using a separate userlist file, you can define rules for sorting specific plugins or groups of plugins as you like, 
as well as for adding or editing messages attached to plugins, and these rules will not be lost when you update your masterlist.

<h2 id="start">Getting Started With The Userlist</h2>
<p><strong>Note:</strong> This ReadMe refers to .esp and .esm files as 'plugins'. Unless explicitely stated, the 'name' of a 'plugin' refers to its filename, including the extension. Also, while the examples in this ReadMe reference Oblivion and some of its plugins, the functionality will work for all the games BOSS supports. When your game's master .ESM file is mentioned, this refers to Oblivion.esm, Nehrim.esm, Fallout3.esm or FalloutNV.esm for Oblivion, Nehrim, Fallout 3 or Fallout: New Vegas respectively.
<p>The userlist is the file which contains your custom rules for sorting plugins and editing plugins' messages. It is found at <code>BOSS\[GAME]\userlist.txt</code>, where <code>[GAME]</code> is one of <code>Oblivion</code>, <code>Nehrim</code>, <code>Skyrim</code>, <code>Fallout 3</code> or <code>Fallout New Vegas</code>, depending on the game the userlist is for. A blank userlist is automatically created for a game when BOSS is first run for that game.
<p>Within this file, which you can edit in Notepad or any other text editor, you list your rule definitions. Rules can make two types of changes:
<ol>
	<li><em>Sort plugins and groups.</em> You can:
		<ul>
			<li>Sort plugins relative to other plugins. You can both override the positions of plugins BOSS recognises and sort plugins unrecognised by BOSS.
			<li>Sort groups of plugins relative to other groups of plugins. You can override the positions of the groups in the BOSS sorts plugins into.
			<li>Insert plugins into groups. You can put plugins at the beginning or end of groups.
		</ul>
		Plugins may be .esp or .esm files. Groups are all pre-defined in the BOSS masterlist, marked out by the 
	<code>\BeginGroup\: <var>Group Name</var></code> and <code>\EndGroup\\</code>, or <code>BEGINGROUP: <var>Group Name</var></code> and <code>ENDGROUP</code>, lines.
	<li><em>Edit BOSS messages.</em> You can add to or replace the plugin-specific messages that are displayed in the BOSS Log.
	See <a href="#messages">The BOSS Message Format</a> below for more details on the message types and syntax.
</ol>
<p>The rule definition syntax is simple and concise, and is explained below.

<h2 id="basics">Rule Basics</h2>
<p>While it is strongly suggested that you read the <a href="#syntax">Rule Definition Syntax</a> section below to gain a proper understanding of user rules, here is a quick start guide for some simple rules.
<h3 id="basics-add">Sorting An Unknown Plugin</h3>
<p>To sort a plugin that is not in the masterlist after another plugin:

<code class="box">ADD: <var>[RULE PLUGIN]</var>
AFTER: <var>[SORT PLUGIN]</var></code>

<p>To sort it before another plugin:

<code class="box">ADD: <var>[RULE PLUGIN]</var>
BEFORE: <var>[SORT PLUGIN]</var></code>

<p>The <em>rule plugin</em> is the plugin you want to add, and the <em>sort plugin</em> is the plugin you want to sort it relative to.
<p>Examples:
<code class="box">ADD: Plugin1.esp
AFTER: AFK_Weye.esp

ADD: Plugin2.esp
BEFORE: AFK_Weye.esp</code>
<p>This gives a load order of:
<blockquote>
...<br />
Plugin2.esp<br />
AFK_Weye.esp<br />
Plugin1.esp<br />
...
</blockquote>

<h3 id="basics-override">Changing A Recognised Plugin's Position</h3>
<p>To sort a plugin that is already in the masterlist after another plugin:
<code class="box">OVERRIDE: <var>[RULE PLUGIN]</var>
AFTER: <var>[SORT PLUGIN]</var></code>
<p>To sort it before another plugin:
<code class="box">OVERRIDE: <var>[RULE PLUGIN]</var>
BEFORE: <var>[SORT PLUGIN]</var></code>
<p>The <em>rule plugin</em> is the plugin you want to sort, and the <em>sort plugin</em> is the plugin you want to sort it relative to.
<p>Example:
<code class="box">OVERRIDE: bgBalancingEVCore.esp
AFTER: Unofficial Oblivion Patch.esp</code>
<p>This gives a load order of:
<blockquote>
...<br />
Unofficial Oblivion Patch.esp<br />
bgBalancingEVCore.esp<br />
...
</blockquote>

<h3 id="basics-message">Editing A Plugin's BOSS Log Messages &amp; Bash Tag Suggestions</h3>
<p>To add a message to a plugin for display in the BOSS Log:
<code class="box">FOR: <var>[RULE PLUGIN]</var>
APPEND: <var>[MESSAGE OBJECT]</var></code>
<p>To replace the messages attached to a plugin for display in the BOSS Log:
<code class="box">FOR: <var>[RULE PLUGIN]</var>
REPLACE: <var>[MESSAGE OBJECT]</var></code>
<p>The <em>rule plugin</em> is the plugin you want to add the message to. The <em>message object</em> is the formatted BOSS message that you want to attach. See the <a href="#messages">The BOSS Message Format</a> section later on in this readme if you are unfamiliar with BOSS message formatting.
<p>An example:
<code class="box">FOR: Unofficial Oblivion Patch.esp
REPLACE: ? Replaced!

FOR: bgMagicEV.esp.esp
APPEND: % {{BASH:Names,Delev,Relev}}</code>
<p>This will print in the BOSS Log:
<blockquote>
...<br /><br />
Unofficial Oblivion Patch.esp
<ul>
	<li>Note:  Replaced!
</ul>
...<br /><br />
bgMagicEV.esp.esp
<ul>
	<li>Bashed Patch tag suggestion: {{BASH:Names,Delev,Relev}}
</ul>
...
</blockquote>

<h2 id="syntax">Rule Definition Syntax</h2>
<p>User rules have a specific structure and syntax which your rules must follow to be applied. The information below provides the details on this structure and syntax.
<h3 id="syntax-rule">The Rule Line</h3>
<p>Every rule begins with a <em>rule line</em>, which defines what basic type of rule it is and what plugin it is applied to. It has the structure:
<code class="box"><var>[RULE KEYWORD]</var>: <var>[RULE OBJECT]</var></code>
<p>This is the <em>rule line</em>. The <em>rule keyword</em> can be one of:
<ul>
	<li><dfn>ADD</dfn>: This tells BOSS that the rule sorts a plugin that is not in the 
	masterlist. The rule may also add and/or edit messages attached to that plugin.
	<li><dfn>OVERRIDE</dfn>: This tells BOSS that the rule overrides the current position of a plugin or group in the masterlist with a new position. 
	The rule may also add and/or edit messages attached to that plugin.
	<li><dfn>FOR</dfn>: This tells BOSS that the rule adds and/or edits the messages attached to a plugin, but does not sort it.
</ul>
<p>The <em>rule object</em> is the plugin or group that the rule is applied to. If the rule keyword is ADD or FOR, the rule object must be a plugin.
<p>When you define groups, the names of those groups are used as they appear in the masterlist. For example, 
if you wanted to reference the group of plugins that begins with <code>\BeginGroup\: Supreme Magicka</code>, you would put it in the rule as <code>Supreme Magicka</code>.
<p>There is one more keyword that can be used on the rule line. <code>DISABLE</code> can be put before the rule keyword to prevent the rule from being applied. For example:
<code class="box">DISABLE ADD: MyMod.esp
AFTER: Unofficial Oblivion Patch.esp
</code>
<p>Would result in MyMod.esp not being sorted after Unofficial Oblivon Patch.esp. The <code>DISABLE</code> keyword should be used instead of silent comments to stop a rule being applied because the latter makes the rule invisible to the GUI's User Rule Editor whereas the former does not.

<h3 id="syntax-sort">The Sort Line</h3>
<p>If a rule's rule keyword is ADD or OVERRIDE, it can sort plugins and should include a <em>sort line</em> directly below the rule line. If the rule keyword is FOR, the rule <b>must not</b> include a sort line. A rule may only contain one sort line. The sort line has the structure:
<code class="box"><var>[SORT KEYWORD]</var>: <var>[SORT OBJECT]</var></code>
<p>The <em>sort keyword</em> can be one of:
<ul>
	<li><dfn>BEFORE</dfn>: This states that the rule object is to load immediately before the sort object.
	<li><dfn>AFTER</dfn>: This states that the rule object is to load immediately after the sort object.
	<li><dfn>TOP</dfn>: This states that the rule plugin is to be inserted into the top of the sort group. The rule plugin will then load before everything else in the sort group.
	<li><dfn>BOTTOM</dfn>: This states that the rule plugin is to be inserted into the bottom of the sort group. The rule plugin will then load after everything else in the sort group.
</ul>
<p>When using the BEFORE or AFTER sort keywords, the <em>sort object</em> is the plugin or group that you wish the rule object 
to be positioned relative to. Plugins must be sorted relative to other plugins, and groups must be sorted relative to groups. You cannot sort plugins relative to groups, or vice versa. You also cannot sort your game's master .ESM, sort other plugins before it, or sort groups before the "ESMs" group.
<p>When using the TOP or BOTTOM sort keywords, the <em>sort object</em> is the <b>group</b> that you wish to insert the rule plugin into. You cannot insert groups into anything, plugins into plugins, or insert anything into the top of the <q>ESMs</q> group.

<h3 id="syntax-message">The Message Line</h3>
<p>If a rule's rule keyword is FOR, it should include at least one <em>message line</em>. A rule with a rule keyword of ADD or OVERRIDE can also include message lines, if they sort a plugin. Message lines have the structure:
<code class="box"><var>[MESSAGE KEYWORD]</var>: <var>[MESSAGE OBJECT]</var></code>
<p>The <em>message keyword</em> can be one of:
<ul>
	<li><dfn>APPEND</dfn>: This states that the message is to be appended to the list of messages attached to the rule plugin.
	<li><dfn>REPLACE</dfn>: This states that the message is to replace any existing message or messages attached to the rule plugin. You may only have up to one <code>REPLACE</code> message line per rule, and if used it must be the first message line.
</ul>
<p>The <em>message object</em> is the message, complete with symbol code, that you wish to attach to the plugin defined by the rule object. You cannot attach messages to groups.
<p>You may have multiple message lines in a rule (but only the first may use the <code>REPLACE</code> message keyword), to add multiple messages to a plugin, or to override an existing set of messages with a new set.

<h3 id="syntax-examples">Examples</h3>
<p>Here is the contents of an example userlist:
<code class="box">ADD: MyPluginToAdd.esp
AFTER: LoadAfterThis.esm
APPEND: ? Adding a general message.
APPEND: $ Incompatible with OOO!

OVERRIDE: MyPluginToOverride.esp
BEFORE: LoadBeforeThis.esp

OVERRIDE: L.A.M.E.
BEFORE: Supreme Magicka

FOR: bgBalancingEVOptionalNPCDiversity, Vanilla.esp
REPLACE: ? This is a replacement message.
APPEND: % {{BASH:NpcFaces,NoMerge}}</code>
<p>This is the equivalent of the masterlist having:
<blockquote>
...<br />
LoadAfterThis.esm<br />
MyPluginToAdd.esp<br />
? Adding a general message.<br />
$ Incompatible with OOO!<br />
...<br />
MyPluginToOverride.esp<br />
LoadBeforeThis.esp<br />
...<br />
bgBalancingEVOptionalNPCDiversity, Vanilla.esp<br />
? This is a replacement message.<br />
% {{BASH:NpcFaces,NoMerge}}<br />
...
</blockquote>
<p>Which would give in the BOSS Log:
<blockquote>
...<br />
LoadAfterThis.esm<br />
MyPluginToAdd.esp
<ul>
	<li>Note: Adding a general message.
	<li>Note: Incompatible with OOO!
</ul>
...<br />
MyPluginToOverride.esp<br />
LoadBeforeThis.esp<br />
...<br />
bgBalancingEVOptionalNPCDiversity, Vanilla.esp
<ul>
<li> Note: This is a replacement message.
<li> Bash Tag Suggestion(s): {{BASH:NpcFaces,NoMerge}}
</ul>
...
</blockquote>
<p>The rule sorting the two groups L.A.M.E. and Supreme Magicka simply moves the L.A.M.E. group from its current position to before the Supreme Magicka group.

<h2 id="apply">Enforcing Your Rules</h2>
<p>When BOSS is run, it will look for your userlist at <code>BOSS\[GAME]\userlist.txt</code>, where <code>[GAME]</code> is one of <code>Oblivion</code>, <code>Nehrim</code>, <code>Skyrim</code>, <code>Fallout 3</code> or <code>Fallout New Vegas</code>, depending on the game BOSS is running for. If it is found, and the userlist contains at least one rule, BOSS will first check the syntax of the rules, and apply those with the correct syntax. 
It will print error messages detailing the problems with any rules it skips, and success messages for the plugins that are applied, into your BOSS Log, in the <q>Userlist Messages</q> section near the top. Disabled rules have their syntax checked, but are not applied.
<p>If a rule is successfully applied, it will print one or more messages depending on what the rule does:
<ol>
	<li>If the rule includes a sort line and uses the sort keywords BEFORE or AFTER, it will print a message of the form: <code>"<var>Plugin/Group Name</var>" sorted <var>before/after</var> "<var>Plugin/Group Name</var>".</code>
	<li>If the rule includes a sort line and uses the sort keywords TOP or BOTTOM, it will print a message of the form: <code>"<var>Plugin Name</var>" inserted into the <var>top/bottom</var> of group "<var>Group Name</var>".</code>
	<li>If the rule includes one or more message lines, each message line will give a message of the form: <code>"<var>Message</var>" <var>appended to/replaced</var> messages attached to "<var>Plugin Name</var>".</code>
</ol>
<p>If the parser finds a major grammatical error in your userlist, it will stop parsing and discard any rules it has found before printing an error message detailing what was expected and where. In some cases, the expected item may not provide much useful meaning - in these cases look at where the error was found and determine the exact cause of the problem yourself.
<p>If a rule is found to have errors in its syntax, it will be skipped and an error message of the form: <code>Syntax Error: The rule beginning "<var>First Line Of Rule</var>" <var>details of error</var></code> will be printed to your BOSS Log. See the main BOSS ReadMe for a full list of possible syntax errors.
<p>If an error is encountered while trying to apply a rule, it will be skipped and an error message detailing the fault will be printed to your BOSS Log.
<p><b>Rule application does not alter your masterlist.txt or userlist.txt.</b> This means that if you want to undo the application of a rule, all you need to do is remove it from your userlist.txt (or disable it) and re-run BOSS.

<h2 id="notes">Further Notes On Rules</h2>
<p>While the <a href="#syntax">Rule Definition Syntax</a> section gave you most of the rules of defining rules, here are some further general notes on defining rules that may not be evident:
<ol>
	<li>Blank lines or lines beginning with <code>//</code> in your userlist will be ignored by BOSS. You can use blank lines to improve the formatting of your userlist, and use the <code>//</code> line start to provide comments or disable specific rules as you desire.
		<ul>
			<li>You can also begin lines with <code>\</code> instead of <code>//</code> to have the same effect, and comment out multiple lines by enclosing them between <code>/*</code> and <code>*/</code>.
			<li>It is better to use the <code>DISABLE</code> keyword to disable rules, as this means that they are still visible to the GUI's User Rule Editor without being applied. Rules with incorrect syntax should be commented out, as disabled rules are still parsed with error checking.
		</ul>
	<li>User rules are case-insensitive. The only exception is the message object, which will retain its case when displayed in the BOSS Log.
	<li>If a rule's rule plugin is not installed in your Data folder, the rule will be skipped.
	<li>Plugins ghosted by Wrye Bash are treated no differently from non-ghosted plugins, but they must be referenced without their ".ghost" extension.
	<li>The group "ESMs" must always load first. You cannot sort this group or sort another group before it.
	<li>The game's master .ESM file must always load first. You cannot sort it, sort another plugin before it, or insert another plugin into the top of the "ESMs" group.
	<li>You cannot sort a plugin relative to another plugin that is not in the masterlist and has not been sorted by a previous rule.
	<li>You cannot include conditionals in any messages added through user rules. While BOSS will not display any errors, the message will be added as if it were a general message with no conditional.
	<li>You cannot sort mods or groups relative to themselves.
	<li>You cannot sort a non-master plugin before a master, or a master after a non-master plugin. Masters are commonly .ESM files, and non-master plugins are commonly .ESP files, but whether a plugin is a master or not is actually decided by a variable in the file, not the file extension. (An example of this in action would be <abbr title="Wrye Bash, Wrye Flash or Wrye Flash NV">Wrye *ash</abbr>'s <q>ESMify Self</q> function, which makes a plugin into a master without changing the file extension.)
	<li>
		<p><b>Rules are applied in the order they are listed</b>. This means you can have several rules sorting different rule objects relative to the same sort object, or have rules sorting rule objects relative to sort objects that were sorted in previous rules.
		For example:
		<code class="box">ADD: LoadBeforeThis.esp
AFTER: RTT.esp

ADD: Plugin1.esp
BEFORE: LoadBeforeThis.esp

OVERRIDE: xulAspenWood.esp
AFTER: Plugin1.esp

ADD: Plugin2.esp
BEFORE: RTT.esp</code>
		<p>which will order the plugins as:
		<blockquote>Plugin2.esp<br />
		RTT.esp<br />
		Plugin1.esp<br />
		xulAspenWood.esp<br />
		LoadBeforeThis.esp</blockquote>
		<p>Take care when writing such rules though, as a small difference in the order of the rules in your userlist can have a very large difference on the resulting load order.
</ol>

<h2 id="messages">The BOSS Message Format</h2>
<p>Understanding the BOSS message format is important if you wish to edit plugins' messages. There are actually two formats, either of which may be used. Each of the four message types that can be added via the userlist begins with a <em>message symbol</em> or <em>message keyword</em> depending on the format used. The symbol/keyword is then followed by the message itself. The message is just a standard line of text. In addition, Bash Tag suggestion messages also have a special syntax for the suggestions they include.
<p>The message message types, symbols and keywords are listen in the table below:
<table>
	<thead><tr><td><b>Message Type</b><td><b>Format 1 Symbol</b><td><b>Format 2 Keyword</b>
	<tbody>
		<tr><td>Bash Tag Suggestion<td>%<td>TAG:
		<tr><td>General Message<td>?<td>SAY:
		<tr><td>Installation Requirement<td>:<td>REQ:
		<tr><td>Specific Incompatibility<td>"<td>INC:
</table>
<p>The syntax for a Bash Tag suggestion is:
<code class="box">% {{BASH:list suggested tags separated by ", " here}} you may also have some text here.</code>
or:<br />
<code class="box">TAG: {{BASH:list suggested tags separated by ", " here}} you may also have some text here.</code>
<p>For example:
<code class="box">% {{BASH:Names, Graphics}} to prevent changes being lost when using overhauls.</code>
<p>You can also mix the two formats, giving one message in one format and another message in the other. You are not restricted to using only one format.

<h2 id="license">License</h2>
<p>This document is part of the BOSS documentation.<br />
Copyright (C) 2011 BOSS Development Team.<br />
See the file <q>BOSS ReadMe.html</q> for copying conditions.