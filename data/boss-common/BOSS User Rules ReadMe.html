<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
	<title>BOSS User Rules ReadMe</title>
	<style type="text/css">
	body {font-family:Calibri,Arial,Verdana,sans-serifs;}
	body > div:first-child {font-size:2.4em; font-weight:bold; text-align:center; margin-bottom:1em;}
	div > span {font-weight:bold; font-size:1.3em;}
	.subtitle {font-weight: normal;font-size:1.3em;}
	ol li, ul li {margin-bottom:10px;}
	li ul, li ol {margin-top:0.4em;}
	.codebox, .quotebox, .logbox {margin-left:40px; border: gray 1px dashed; display:table; min-width:300px;  padding: 5px 30px 5px 10px;}
	.codebox { font-family: monospace; background:#F5F5F5; line-height:20px;}
	.quotebox {background:#E6E6FA;}
	.logbox {background:#E0FFFF; line-height:30px;}
	.logbox > ul > li {line-height:20px;}
	q {font-style:italic;}
	code {display:inline-box; padding: 2px 5px; background:#EEEEEE; }
	</style>
  </head>
	<body>
	<div>Better Oblivion Sorting Software<br />
	User Rules Documentation</div>
	
	<div><span>Contents</span>
	<ol>
		<li><a href="#intro">Introduction</a></li>
		<li><a href="#start">Getting Started With The Userlist</a></li>
		<li><a href="#basics">Rule Basics</a>
		<ol style="list-style:lower-alpha;">
			<li><a href="#unknown">Sorting An Unknown Mod</a></li>
			<li><a href="#recognised">Changing A Recognised Mod's Position</a></li>
			<li><a href="#message">Editing A Mod's BOSSlog Messages &amp; Bash Tag Suggestions</a></li>
		</ol>
		</li>
		<li><a href="#syntax">Rule Definition Syntax</a></li>
		<li><a href="#apply">Enforcing Your Rules</a></li>
		<li><a href="#notes">Further Notes On Rules</a></li>
		<li><a href="#messages">The BOSS Message Format</a></li>
	</ol>
	</div><br /><br />

	<div id="intro"><span>Introduction</span>
	<p>While BOSS is able to sort the large number of mods listed in its masterlist without any user input, you may find that you wish to customise 
	the sorting of your mods. This may be to include mods not listed in the masterlist (either mods not yet added or temporary plugins or private files not suitable for masterlist inclusion), or it could be to rearrange mods present in the masterlist that can be loaded in a different configuration 
	for different results (eg. LAME and Supreme Magicka files). You may also wish to add extra messages to mods, or edit existing messages.</p>
	<p>One possible solution is to edit your copy of the masterlist to include the desired changes. However, as updating your masterlist will remove 
	these edits, this is not very suitable as a long term solution.</p>
	<p>This is where user rules come in. Using a separate userlist file, you can define rules for sorting specific mods or groups of mods as you like, 
	as well as for adding or editing messages attached to mods, and these rules will not be lost when you update your masterlist.</p>
	</div><br /><br />
  
	<div id="start"><span>Getting Started With The Userlist</span>
	<p style="color:purple">NOTE: In this readme, the words 'mod' and 'plugin' are used interchangeably, meaning 'one individual file with a .esp or 
	.esm extension'. Unless explicitely stated, the 'name' of a 'mod' or 'plugin' refers to its filename, including the extension.<br /><br />
	Also, while the examples in this ReadMe reference Oblivion and some of its mods, the functionality will work for all the games BOSS supports. When your game's master .ESM file is mentioned, this refers to Oblivion.esm, Nehrim.esm, Fallout3.esm or FalloutNV.esm for Oblivion, Nehrim, Fallout 3 or Fallout: New Vegas respectively.</p>
	<p>The userlist is the file which contains your custom rules for sorting mods and editing mods' messages. It is found at <code>BOSS\userlist.txt</code>. A blank userlist is automatically created when BOSS is first run.</p>
	<p>Within this file, which you can edit in Notepad or any other text editor, you list your rule definitions. Rules can make two types of changes:</p>
	<ol class="list">
		<li><em>Sort mods and groups.</em> You can:
			<ul>
				<li>Sort plugins relative to other plugins. You can both override the positions of plugins BOSS recognises and sort plugins unrecognised by BOSS.</li>
				<li>Sort groups of plugins relative to other groups of plugins. You can override the positions of the groups in the BOSS sorts mods into.</li>
				<li>Insert plugins into groups. You can put plugins at the beginning or end of groups.</li>
			</ul>
			Plugins may be .esp or .esm files. Groups are all pre-defined in the BOSS masterlist, marked out by the 
		<code>\BeginGroup\:  <em>Group Name</em></code> and <code>\EndGroup\\</code> lines.</li>
		<li><em>Edit BOSS messages.</em> You can add to or replace the mod-specific messages that are displayed in the BOSSlog.
		See <q><a href="#messages">The BOSS Message Format</a></q> below for more details on the message types and syntax.</li>
	</ol>
	<p>The rule definition syntax is simple and concise, and is explained below.</p>
	</div><br /><br />
	
	<div id="basics"><span>Rule Basics</span>
	<p>While it is strongly suggested that you read the <q><a href="#syntax">Rule Definition Syntax</a></q> section below to gain a proper understanding of user rules, here is a quick start guide for some simple rules.</p>
	<span class="subtitle" id="unknown">Sorting An Unknown Mod</span>
	<p>To sort a mod that is not in the masterlist after another mod:</p>
	<div class="codebox">
	ADD: [RULE MOD]<br />
	AFTER: [SORT MOD]
	</div>
	<p>To sort it before another mod:</p>
	<div class="codebox">
	ADD: [RULE MOD]<br />
	BEFORE: [SORT MOD]
	</div>
	<p>The <em>rule mod</em> is the mod you want to add, and the <em>sort mod</em> is the mod you want to sort it relative to.</p>
	<p>Examples:</p>
	<div class="codebox">
	ADD: Mod1.esp<br />
	AFTER: AFK_Weye.esp<br /><br />
	ADD: Mod2.esp<br />
	BEFORE: AFK_Weye.esp
	</div>
	<p>This gives a load order of:</p>
	<div class="quotebox">
	...<br />
	Mod2.esp<br />
	AFK_Weye.esp<br />
	Mod1.esp<br />
	...
	</div><br />
	
	<br /><span class="subtitle" id="recognised">Changing A Recognised Mod's Position</span>
	<p>To sort a mod that is already in the masterlist after another mod:</p>
	<div class="codebox">
	OVERRIDE: [RULE MOD]<br />
	AFTER: [SORT MOD]
	</div>
	<p>To sort it before another mod:</p>
	<div class="codebox">
	OVERRIDE: [RULE MOD]<br />
	BEFORE: [SORT MOD]
	</div>
	<p>The <em>rule mod</em> is the mod you want to sort, and the <em>sort mod</em> is the mod you want to sort it relative to.</p>
	<p>Example:</p>
	<div class="codebox">
	OVERRIDE: bgBalancingEVCore.esp<br />
	AFTER: Unofficial Oblivion Patch.esp
	</div>
	<p>This gives a load order of:</p>
	<div class="quotebox">
	...<br />
	Unofficial Oblivion Patch.esp<br />
	bgBalancingEVCore.esp<br />
	...
	</div><br />
	
	<br /><span class="subtitle" id="message">Editing A Mod's BOSSlog Messages &amp; Bash Tag Suggestions</span>
	<p>To add a message to a mod for display in the BOSSlog:</p>
	<div class="codebox">
	FOR: [RULE MOD]<br />
	APPEND: [MESSAGE OBJECT]
	</div>
	<p>To replace the messages attached to a mod for display in the BOSSlog:</p>
	<div class="codebox">
	FOR: [RULE MOD]<br />
	REPLACE: [MESSAGE OBJECT]
	</div>
	<p>The <em>rule mod</em> is the mod you want to add the message to. The <em>message object</em> is the formatted BOSS message that you want to attach. See the <q><a href="#messages">The BOSS Message Format</a></q> section later on in this readme if you are unfamiliar with BOSS message formatting.</p>
	<p>An example:</p>
	<div class="codebox">
	FOR: Unofficial Oblivion Patch.esp<br />
	REPLACE: ? Replaced!<br /><br />
	FOR: bgMagicEV.esp.esp<br />
	APPEND: % {{BASH:Names,Delev,Relev}}
	</div>
	<p>This will print in the BOSSlog:</p>
	<div class="quotebox">
	...<br /><br />
	Unofficial Oblivion Patch.esp
	<ul>
		<li>Note:  Replaced!</li>
	</ul>
	...<br /><br />
	bgMagicEV.esp.esp
	<ul>
		<li>Bashed Patch tag suggestion: {{BASH:Names,Delev,Relev}}</li>
	</ul>
	...
	</div>
	</div><br /><br />
	
	<div id="syntax"><span>Rule Definition Syntax</span><br />
	<p>User rules have a specific structure and syntax which your rules must follow to be applied. The information below provides the details on this structure and syntax.</p>
	<br /><span class="subtitle">The Rule Line</span>
	<p>Every rule begins with a <em>rule line</em>, which defines what basic type of rule it is and what plugin it is applied to. It has the structure:</p>
	<div class="codebox">[RULE KEYWORD]: [RULE OBJECT]</div>
	<p>This is the <em>rule line</em>. The <em>rule keyword</em> can be one of:</p>
	<ul>
		<li><em>ADD</em>: This tells BOSS that the rule sorts a mod that is not in the 
		masterlist. The rule may also add and/or edit messages attached to that mod.</li>
		<li><em>OVERRIDE</em>: This tells BOSS that the rule overrides the current position of a mod or group in the masterlist with a new position. 
		The rule may also add and/or edit messages attached to that mod.</li>
		<li><em>FOR</em>: This tells BOSS that the rule adds and/or edits the messages attached to a mod, but does not sort it.</li>
	</ul>
	<p>The <em>rule object</em> is the mod or group that the rule is applied to. If the rule keyword is ADD or FOR, the rule object must be a mod.</p>
	<p>When you define groups, the names of those groups are used as they appear in the masterlist. For example, 
	if you wanted to reference the group of mods that begins with <code>\BeginGroup\: Supreme Magicka</code>, you would put it in the rule as 
	<code>Supreme Magicka</code>.</p>
	
	<br /><span class="subtitle">The Sort Line</span>
	<p>If a rule's rule keyword is ADD or OVERRIDE, it can sort mods and should include a <em>sort line</em>. If the rule keyword is FOR, the rule <b>must not</b> include a sort line. The sort line has the structure:</p>
	<div class="codebox">[SORT KEYWORD]: [SORT OBJECT]</div>
	<p>The <em>sort keyword</em> can be one of:</p>
	<ul>
		<li><em>BEFORE</em>: This states that the rule object is to load immediately before the sort object.</li>
		<li><em>AFTER</em>: This states that the rule object is to load immediately after the sort object.</li>
		<li><em>TOP</em>: This states that the rule mod is to be inserted into the top of the sort group. The rule mod will then load before everything else in the sort group.</li>
		<li><em>BOTTOM</em>: This states that the rule mod is to be inserted into the top of the sort group. The rule mod will then load after everything else in the sort group.</li>
	</ul>
	<p>When using the BEFORE or AFTER sort keywords, the <em>sort object</em> is the plugin or group that you wish the rule object 
	to be positioned relative to. Mods must be sorted relative to other mods, and groups must be sorted relative to groups. You cannot sort mods relative to groups, or vice versa. You also cannot sort your game's master .ESM, sort other mods before it, or sort groups before the "ESMs" group.</p>
	<p>When using the TOP or BOTTOM sort keywords, the <em>sort object</em> is the <b>group</b> that you wish to insert the rule mod into. You cannot insert groups into anything, mods into mods, or insert anything into the top of the "ESMs" group.</p>
	
	<br /><span class="subtitle">The Message Line</span>
	<p>If a rule's rule keyword is FOR, it should include at least one <em>message line</em>. A rule with a rule keyword of ADD or OVERRIDE can also include message lines, if they sort a mod. Message lines have the structure:</p>
	<div class="codebox">[MESSAGE KEYWORD]: [MESSAGE OBJECT]</div>
	<p>The <em>message keyword</em> can be one of:</p>
	<ul>
		<li><em>APPEND</em>: This states that the message is to be appended to the list of messages attached to the rule mod.</li>
		<li><em>REPLACE</em>: This states that the message is to replace any existing message or messages attached to the rule mod.</li>
	</ul>
	<p>The <em>message object</em> is the message, complete with symbol code, that you wish to attach to the mod defined by the rule object. You cannot attach messages to groups.</p>
	<p>You may have multiple message lines in a rule, to add multiple messages to a mod, or to override an existing set of messages with a new set.</p>
	
	<br /><span class="subtitle">Examples</span>
	<p>Here is the contents of an example userlist:</p>
	<div class="codebox">
	ADD: MyModToAdd.esp<br />
	AFTER: LoadAfterThis.esm<br />
	APPEND: ? Adding a general comment.<br />
	APPEND: $ Incompatible with OOO!<br /><br />
	
	OVERRIDE: MyModToOverride.esp<br />
	BEFORE: LoadBeforeThis.esp<br /><br />
	
	OVERRIDE: L.A.M.E.<br />
	BEFORE: Supreme Magicka<br /><br />
	
	FOR: bgBalancingEVOptionalNPCDiversity, Vanilla.esp<br />
	REPLACE: ? This is a replacement message.<br />
	APPEND: % {{BASH:NpcFaces,NoMerge}}
	</div>
	<p>This is the equivalent of the masterlist having:</p>
	<div class="quotebox">
	...<br />
	LoadAfterThis.esm<br />
	MyModToAdd.esp<br />
	? Adding a general comment.<br />
	$ Incompatible with OOO!<br />
	...<br />
	MyModToOverride.esp<br />
	LoadBeforeThis.esp<br />
	...<br />
	bgBalancingEVOptionalNPCDiversity, Vanilla.esp<br />
	? This is a replacement message.<br />
	% {{BASH:NpcFaces,NoMerge}}<br />
	...
	</div>
	<p>Which would give in the BOSSlog:</p>
	<div class="logbox" style="">
	...<br />
	LoadAfterThis.esm<br />
	MyModToAdd.esp
	<ul>
		<li>Note: Adding a general comment.</li>
		<li>Note: Incompatible with OOO!</li>
	</ul>
	...<br />
	MyModToOverride.esp<br />
	LoadBeforeThis.esp<br />
	...<br />
	bgBalancingEVOptionalNPCDiversity, Vanilla.esp
	<ul>
	<li> Note: This is a replacement message.</li>
	<li> Bash Tag Suggestion(s): {{BASH:NpcFaces,NoMerge}}</li>
	</ul>
	...
	</div>
	<p>The rule sorting the two groups L.A.M.E. and Supreme Magicka simply moves the L.A.M.E. group from its current position to before the Supreme Magicka group.</p>
	</div>
	<br /><br />
	
	<div id="apply"><span>Enforcing Your Rules</span>
	<p>When BOSS is run, it will look for your userlist at <code>Data\BOSS\userlist.txt</code>. If it is found, and the userlist contains at least one rule, BOSS will first check the syntax of the rules, and apply those with the correct syntax. 
	It will print error messages detailing the problems with any rules it skips, and success messages for the mods that are applied, into your BOSSlog.txt, in a section headed "Userlist Messages" near the top.</p>
	<p>If a rule is successfully applied, it will print one or more messages depending on what the rule does:</p>
	<ol>
		<li>If the rule includes a sort line and uses the sort keywords BEFORE or AFTER, it will print a message of the form: <code>"<em>Mod/Group Name</em>" sorted <em>before/after</em> "<em>Mod/Group Name</em>".</code></li>
		<li>If the rule includes a sort line and uses the sort keywords TOP or BOTTOM, it will print a message of the form: <code>"<em>Mod Name</em>" inserted into the <em>top/bottom</em> of group "<em>Group Name</em>".</code></li>
		<li>If the rule includes one or more message lines, each message line will give a message of the form: <code>"<em>Message</em>" <em>appended to/replaced</em> messages attached to "<em>Mod Name</em>".</code></li>
	</ol>
	<p>If the parser finds a major grammatical error in your userlist, it will stop parsing and discard any rules it has found before printing an error message detailing what was expected and where. Depending on where the error was found, more than one message may be displayed. In some cases, the expected item may not provide much useful meaning - in these cases look at where the error was found and determine the exact cause of the problem yourself.</p>
	<p>If a rule is found to have errors in its syntax, it will be skipped and an error message of the form: <code>Syntax Error: The rule beginning "<em>First Line Of Rule</em>" <em>details of error</em></code> will be printed to your BOSSlog.</p>
	<p>If an error is encountered while trying to apply a rule, it will be skipped and an error message detailing the fault will be printed to your BOSSlog.</p>
	<p><b>Rule application does not alter your masterlist.txt or userlist.txt.</b> This means that if you want to undo the application of
	a rule, all you need to do is remove it from your userlist.txt and re-run BOSS.</p>
	</div><br /><br />
	
	<div id="notes"><span>Further Notes On Rules</span>
	<p>While the <q><a href="#syntax">Rule Definition Syntax</a></q> section gave you most of the rules of defining rules, here are some further general notes on defining rules that may 
	not be evident:</p>
	<ol>
		<li>Blank lines or lines beginning with "//" (without quotes) in your userlist will be ignored by BOSS. You can use blank lines to improve the formatting of your userlist, and use the "//" line start to provide comments or disable specific rules as you desire.</li>
		<li>User rules are case-insensitive. The only exception is the message object, which will retain its case when displayed in the BOSSlog.</li>
		<li>If a rule's rule mod is not installed in your Data folder, the rule will be skipped.</li>
		<li>Mods ghosted by Wrye Bash are treated no differently from non-ghosted mods, but they must be referenced without their ".ghost" extension.</li>
		<li>The group "ESMs" must always load first. You cannot sort this group or sort another group before it.</li>
		<li>The game's master .ESM file must always load first. You cannot sort it, sort another mod before it, or insert another mod into the top of the "ESMs" group.</li>
		<li>You cannot sort a mod relative to another mod that is not in the masterlist and has not been sorted by a previous rule.</li>
		<li>
			<p><b>Rules are applied in the order they are listed</b>. This means you can have several rules sorting different rule objects relative to the same sort object, or have rules sorting rule objects relative to sort objects that were sorted in previous rules.
			For example:</p>
			<div class="codebox">
			ADD: LoadBeforeThis.esp<br />
			AFTER: RTT.esp<br /><br />
			ADD: Mod1.esp<br />
			BEFORE: LoadBeforeThis.esp<br /><br />
			OVERRIDE: xulAspenWood.esp<br />
			AFTER: Mod1.esp<br /><br />
			ADD: Mod2.esp<br />
			BEFORE: RTT.esp
			</div>
			<p>which will order the mods as:</p>
			<div class="quotebox">Mod2.esp<br />
			RTT.esp<br />
			Mod1.esp<br />
			xulAspenWood.esp<br />
			LoadBeforeThis.esp</div>
			<p>Take care when writing such rules though, 
			as a small difference in the order of the rules in your userlist can have a very large difference on the resulting load order.</p>
		</li>
	</ol>
	</div><br /><br />
	
	<div id="messages"><span>The BOSS Message Format</span>
	<p>Understanding the BOSS message format is important if you wish to edit mods' messages. There are actually two formats, either of which may be used. 
	Each of the four message types that can be added via the userlist begins with a 
	<em>message symbol</em> or <em>message keyword</em> depending on the format used. The symbol/keyword is then followed by the message itself. The message is just a standard 
	line of text. In addition, Bash Tag suggestion comments also have a special syntax for the suggestions they include.</p>
	<p>The message message types, symbols and keywords are listen in the table below:</p>
	<div style="float:left;">
	<div style="border: 1px solid grey; padding: 5px; font-weight:bold;">Message Type</div>
	<div style="border: 1px solid grey; padding: 5px;">Bash Tag Suggestion</div>
	<div style="border: 1px solid grey; padding: 5px;">General Comment</div>
	<div style="border: 1px solid grey; padding: 5px;">Installation Requirement</div>
	<div style="border: 1px solid grey; padding: 5px;">Specific Incompatibility</div>
	</div>
	<div style="float:left;">
	<div style="border: 1px solid grey; padding: 5px; font-weight:bold;">Format 1 Symbol</div>
	<div style="border: 1px solid grey; padding: 5px;">%</div>
	<div style="border: 1px solid grey; padding: 5px;">?</div>
	<div style="border: 1px solid grey; padding: 5px;">:</div>
	<div style="border: 1px solid grey; padding: 5px;">"</div>
	</div>
	<div style="float:left;">
	<div style="border: 1px solid grey; padding: 5px; font-weight:bold;">Format 2 Keyword</div>
	<div style="border: 1px solid grey; padding: 5px;">TAG:</div>
	<div style="border: 1px solid grey; padding: 5px;">SAY:</div>
	<div style="border: 1px solid grey; padding: 5px;">REQ:</div>
	<div style="border: 1px solid grey; padding: 5px;">INC:</div>
	</div>
	<p style="clear:both;"><br />The syntax for a Bash Tag suggestion is:<br /><br />
	% {{BASH:list suggested tags separated by ", " here}} you may also have some text here.<br />
	or:<br />
	TAG: {{BASH:list suggested tags separated by ", " here}} you may also have some text here.</p>
	<p>For example:</p>
	<div class="codebox">% {{BASH:Names, Graphics}} to prevent changes being lost when using overhauls.</div>
	<p>You can also mix the two formats, giving one message in one format and another message in the other. You are not restricted to using only one format.</p>
	</div><br /><br />
	</body>
</html>